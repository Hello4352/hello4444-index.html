<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ìë¦¬ ë½‘ê¸° ì‚¬ì´íŠ¸</title>
  <style>
    body { font-family: sans-serif; }
    .layout {
      display: flex;
      justify-content: center;
      gap: 40px;
      margin-top: 20px;
    }
    .section {
      display: grid;
      gap: 10px;
    }
    .left { grid-template-columns: repeat(2, 60px); grid-template-rows: repeat(4, 60px); }
    .center, .right { grid-template-columns: repeat(2, 60px); grid-template-rows: repeat(5, 60px); }
    .cell {
      background: #f0f0f0;
      border: 1px solid #aaa;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      cursor: pointer;
    }
    .clicked {
      background: #ffcccc;
    }
    .board {
      width: 400px;
      margin: 0 auto;
      height: 40px;
      background: #d0d0d0;
      text-align: center;
      line-height: 40px;
      font-weight: bold;
      margin-bottom: 10px;
    }
    .inputs {
      text-align: center;
      margin-bottom: 10px;
    }
    .unplaced-box {
      max-width: 600px;
      margin: 20px auto;
      background: #ffeeee;
      border: 1px dashed #ff9999;
      padding: 10px;
      font-size: 16px;
      text-align: center;
    }
  </style>
</head>
<body>
  <h2 style="text-align:center;">ìë¦¬ ë½‘ê¸°</h2>
  <div class="board">(ì¹ íŒ)</div>

  <div class="inputs">
    ì‹œì‘ ë²ˆí˜¸: <input type="number" id="startNum" value="1">
    ë ë²ˆí˜¸: <input type="number" id="endNum" value="28">
    ì œì™¸í•  ë²ˆí˜¸(ì‰¼í‘œë¡œ): <input type="text" id="excludeNums" placeholder="ì˜ˆ: 3,5,12">
    <button onclick="generateSeats()">ìë¦¬ ìƒì„±</button>
  </div>

  <div class="layout">
    <div class="section left" id="leftSection"></div>
    <div class="section center" id="centerSection"></div>
    <div class="section right" id="rightSection"></div>
  </div>

  <div id="unplaced" class="unplaced-box" style="display:none;"></div>

  <script>
    const TOTAL_SEATS = 28;
    const seatStates = Array(TOTAL_SEATS).fill(null); // "X" or null

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }

    function createCell(seatIndex, value) {
      const div = document.createElement("div");
      div.className = "cell";
      div.textContent = value;
      div.dataset.seatIndex = seatIndex;

      if (seatStates[seatIndex] === "X") {
        div.textContent = "Ã—";
        div.classList.add("clicked");
      }

      div.addEventListener("click", () => {
        const idx = parseInt(div.dataset.seatIndex);
        if (seatStates[idx] === "X") {
          seatStates[idx] = null;
          div.textContent = value;
          div.classList.remove("clicked");
        } else {
          seatStates[idx] = "X";
          div.textContent = "Ã—";
          div.classList.add("clicked");
        }
      });

      return div;
    }

    function generateSeats() {
      const start = parseInt(document.getElementById("startNum").value);
      const end = parseInt(document.getElementById("endNum").value);
      const excludeRaw = document.getElementById("excludeNums").value;
      const exclude = excludeRaw.split(",").map(s => parseInt(s.trim())).filter(n => !isNaN(n));

      const left = document.getElementById("leftSection");
      const center = document.getElementById("centerSection");
      const right = document.getElementById("rightSection");
      const unplacedBox = document.getElementById("unplaced");
      left.innerHTML = center.innerHTML = right.innerHTML = "";
      unplacedBox.style.display = "none";
      unplacedBox.innerHTML = "";

      if (start >= end || start < 1 || end < 1) {
        alert("ì‹œì‘ê³¼ ë ë²ˆí˜¸ë¥¼ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”.");
        return;
      }

      let numbers = [];
      for (let i = start; i <= end; i++) {
        if (!exclude.includes(i)) numbers.push(i);
      }

      const freeIndices = seatStates.map((v, i) => v !== "X" ? i : null).filter(i => i !== null);
      shuffle(numbers);

      const assigned = numbers.slice(0, freeIndices.length);
      const leftover = numbers.slice(freeIndices.length);
      const blanksNeeded = freeIndices.length - assigned.length;

      // ğŸ¯ ì¢Œì„ ì¸ë±ìŠ¤ì™€ ê°’(ë²ˆí˜¸ ë˜ëŠ” ë¹ˆì¹¸)ì„ í•¨ê»˜ ë¬¶ê³ , ì „ì²´ë¥¼ ë¬´ì‘ìœ„ ì„ê¸°
      const seatsToAssign = freeIndices.map((idx, i) => ({
        seatIndex: idx,
        value: i < assigned.length ? assigned[i] : ""
      }));
      shuffle(seatsToAssign);

      const values = Array(TOTAL_SEATS).fill("");
      seatsToAssign.forEach(({ seatIndex, value }) => {
        values[seatIndex] = value;
      });

      const sections = [
        { el: left, count: 8 },
        { el: center, count: 10 },
        { el: right, count: 10 }
      ];

      let seatIndex = 0;
      sections.forEach(section => {
        for (let i = 0; i < section.count; i++) {
          const value = values[seatIndex];
          section.el.appendChild(createCell(seatIndex, value));
          seatIndex++;
        }
      });

      if (leftover.length > 0) {
        unplacedBox.style.display = "block";
        unplacedBox.textContent = "ë°°ì¹˜ë˜ì§€ ëª»í•œ ë²ˆí˜¸: " + leftover.join(", ");
      }
    }
  </script>
</body>
</html>
